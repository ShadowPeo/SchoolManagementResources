## Detect vulnerablity for CVE-2022-30190
# Detection
try {

    # evaluate the compliance
    if ((Test-Path -Path registry::HKEY_CLASSES_ROOT\ms-msdt ) -eq $true) #Failure due to the fact that path exists
    { 

        Write-Host "Failure, Vulnerable to CVE-2022-30190"
        exit 1
    }
    else 
    {
        Write-Host "Success, Not vulnerable to CVE-2022-30190"
        exit 0    
    }
}
catch {
    $errMsg = _.Exception.Message
    Write-Host $errMsg
    exit 1
}